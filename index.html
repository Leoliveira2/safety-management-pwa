<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de Gest√£o de Seguran√ßa do Trabalho - Monitoramento Avan√ßado e An√°lise Inteligente de Ocorr√™ncias SST">
    <title>Sistema de Gest√£o de Seguran√ßa do Trabalho - Professional</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="assets/css/styles.css" as="style">
    <link rel="preload" href="assets/js/app.js" as="script">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.7/dayjs.min.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen" aria-hidden="true">
        <div class="loading-content">
            <div class="spinner" aria-label="Carregando"></div>
            <p>Carregando Sistema SST...</p>
        </div>
    </div>

    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>

    <div class="container">
        <!-- Header -->
        <header class="header" role="banner">
            <h1>Sistema de Gest√£o de Seguran√ßa do Trabalho</h1>
            <p>Monitoramento Avan√ßado e An√°lise Inteligente de Ocorr√™ncias SST</p>
        </header>

        <!-- Main Content -->
        <main id="main-content" role="main">
            <!-- Toolbar -->
            <section class="toolbar" role="toolbar" aria-label="Ferramentas principais">
                <button class="btn btn-success" onclick="occurrenceManager.generateSampleData()" aria-describedby="sample-data-desc">
                    <span aria-hidden="true">üé≤</span> Gerar Dados Exemplo
                </button>
                <div id="sample-data-desc" class="sr-only">Gera dados de exemplo para demonstra√ß√£o do sistema</div>
                
                <button class="btn btn-export" onclick="occurrenceManager.showExportModal()" aria-describedby="export-desc">
                    <span aria-hidden="true">üìä</span> Exportar Relat√≥rio
                </button>
                <div id="export-desc" class="sr-only">Exporta relat√≥rios em formato CSV ou JSON</div>
                
                <div class="file-input">
                    <button class="btn btn-import" onclick="document.getElementById('importFile').click()" aria-describedby="import-desc">
                        <span aria-hidden="true">üì•</span> Importar Dados
                    </button>
                    <input type="file" id="importFile" accept=".csv,.xlsx" onchange="occurrenceManager.importData(event)" class="sr-only" aria-label="Selecionar arquivo para importar">
                    <div id="import-desc" class="sr-only">Importa dados de arquivo CSV ou Excel</div>
                </div>
                
                <button class="btn btn-backup" onclick="occurrenceManager.showBackupModal()" aria-describedby="backup-desc">
                    <span aria-hidden="true">üíæ</span> Backup/Restore
                </button>
                <div id="backup-desc" class="sr-only">Cria backup ou restaura dados do sistema</div>
                
                <button class="btn btn-primary" onclick="occurrenceManager.generateAutomaticReport()" aria-describedby="report-desc">
                    <span aria-hidden="true">üìã</span> Relat√≥rio Autom√°tico
                </button>
                <div id="report-desc" class="sr-only">Gera relat√≥rio autom√°tico com dados atuais</div>
            </section>

            <!-- Alerts Container -->
            <div id="alertsContainer" role="alert" aria-live="polite"></div>

            <!-- Formul√°rio de Registro -->
            <section class="section-card" aria-labelledby="form-heading">
                <div class="section-header">
                    <h2 id="form-heading">üìù Registrar Nova Ocorr√™ncia</h2>
                    <button class="btn btn-primary btn-small" onclick="occurrenceManager.resetForm()" aria-label="Limpar formul√°rio">
                        <span aria-hidden="true">üîÑ</span> Limpar
                    </button>
                </div>
                <div class="section-content">
                    <form id="occurrenceForm" novalidate>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="occurrenceId">ID da Ocorr√™ncia</label>
                                <input type="text" id="occurrenceId" readonly aria-describedby="id-help">
                                <small id="id-help" class="form-help">ID gerado automaticamente</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceDate">Data da Ocorr√™ncia <span class="required">*</span></label>
                                <input type="date" id="occurrenceDate" required aria-describedby="date-error">
                                <div id="date-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceTime">Hor√°rio <span class="required">*</span></label>
                                <input type="time" id="occurrenceTime" required aria-describedby="time-error">
                                <div id="time-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceLocation">Localiza√ß√£o <span class="required">*</span></label>
                                <input type="text" id="occurrenceLocation" placeholder="Ex: √Årea de Produ√ß√£o, Escrit√≥rio" required aria-describedby="location-error">
                                <div id="location-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceCategory">Categoria <span class="required">*</span></label>
                                <select id="occurrenceCategory" required aria-describedby="category-error">
                                    <option value="">Selecione uma categoria</option>
                                    <option value="Queda">Queda</option>
                                    <option value="Choque">Choque</option>
                                    <option value="Desvio">Desvio</option>
                                    <option value="Corte">Corte</option>
                                    <option value="Fratura">Fratura</option>
                                    <option value="Queimadura">Queimadura</option>
                                    <option value="Intoxica√ß√£o">Intoxica√ß√£o</option>
                                    <option value="Outro">Outro</option>
                                </select>
                                <div id="category-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceSeverity">Gravidade <span class="required">*</span></label>
                                <select id="occurrenceSeverity" required aria-describedby="severity-error">
                                    <option value="">Selecione a gravidade</option>
                                    <option value="Leve">Leve</option>
                                    <option value="Moderada">Moderada</option>
                                    <option value="Grave">Grave</option>
                                </select>
                                <div id="severity-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceType">Tipo <span class="required">*</span></label>
                                <select id="occurrenceType" required aria-describedby="type-error">
                                    <option value="">Selecione o tipo</option>
                                    <option value="Acidente">Acidente</option>
                                    <option value="Incidente">Incidente</option>
                                </select>
                                <div id="type-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceBodyPart">Parte do Corpo Afetada</label>
                                <select id="occurrenceBodyPart">
                                    <option value="">Selecione</option>
                                    <option value="M√£o">M√£o</option>
                                    <option value="Cabe√ßa">Cabe√ßa</option>
                                    <option value="Joelho">Joelho</option>
                                    <option value="Bra√ßo">Bra√ßo</option>
                                    <option value="Perna">Perna</option>
                                    <option value="Tronco">Tronco</option>
                                    <option value="Olho">Olho</option>
                                    <option value="P√©">P√©</option>
                                    <option value="Costas">Costas</option>
                                    <option value="Outra">Outra</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceResponsibleManagement">Ger√™ncia Respons√°vel <span class="required">*</span></label>
                                <input type="text" id="occurrenceResponsibleManagement" placeholder="Ex: Manuten√ß√£o, RH" required aria-describedby="management-error">
                                <div id="management-error" class="error-message" role="alert"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceInvolvedPeople">Pessoas Envolvidas</label>
                                <input type="number" id="occurrenceInvolvedPeople" min="1" value="1" placeholder="N√∫mero de pessoas">
                            </div>
                            
                            <div class="form-group">
                                <label for="occurrenceWorkHours">Horas de Exposi√ß√£o</label>
                                <input type="number" id="occurrenceWorkHours" step="0.1" placeholder="Ex: 8.0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="occurrenceHighPotential">
                                <label for="occurrenceHighPotential" class="tooltip" data-tooltip="Evento que em circunst√¢ncias diferentes poderia ter resultado em fatalidade">
                                    <span aria-hidden="true">‚ö†Ô∏è</span> Alto Potencial
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="occurrenceFatalAccident">
                                <label for="occurrenceFatalAccident">
                                    <span aria-hidden="true">üíÄ</span> Acidente Fatal
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="occurrenceDescription">Descri√ß√£o Detalhada</label>
                            <textarea id="occurrenceDescription" rows="4" placeholder="Descreva detalhadamente o que aconteceu..."></textarea>
                        </div>

                        <div class="form-group form-actions">
                            <button type="submit" class="btn btn-primary">
                                <span aria-hidden="true">üíæ</span> Registrar Ocorr√™ncia
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- KPIs Section -->
            <section class="section-card kpi-section" aria-labelledby="kpi-heading">
                <div class="section-header">
                    <h2 id="kpi-heading">üìà Indicadores Chave de Performance (KPIs)</h2>
                </div>
                <div class="section-content">
                    <div class="stats-grid" id="kpiStats" role="region" aria-label="Indicadores de performance"></div>
                </div>
            </section>

            <!-- Dashboard Geral -->
            <section class="section-card" aria-labelledby="dashboard-heading">
                <div class="section-header">
                    <h2 id="dashboard-heading">üìä Dashboard Geral de Ocorr√™ncias</h2>
                </div>
                <div class="section-content">
                    <!-- Resumo Estat√≠stico -->
                    <div class="stats-grid" id="statsSummary" role="region" aria-label="Resumo estat√≠stico"></div>

                    <!-- Filtros -->
                    <div class="filters-container" role="region" aria-labelledby="filters-heading">
                        <h3 id="filters-heading" class="filters-title">üîç Filtros de An√°lise</h3>
                        <div class="filters-grid">
                            <div class="form-group">
                                <label for="filterYear">Ano</label>
                                <select id="filterYear">
                                    <option value="">Todos os anos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterMonth">M√™s</label>
                                <select id="filterMonth">
                                    <option value="">Todos os meses</option>
                                    <option value="1">Janeiro</option>
                                    <option value="2">Fevereiro</option>
                                    <option value="3">Mar√ßo</option>
                                    <option value="4">Abril</option>
                                    <option value="5">Maio</option>
                                    <option value="6">Junho</option>
                                    <option value="7">Julho</option>
                                    <option value="8">Agosto</option>
                                    <option value="9">Setembro</option>
                                    <option value="10">Outubro</option>
                                    <option value="11">Novembro</option>
                                    <option value="12">Dezembro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterType">Tipo</label>
                                <select id="filterType">
                                    <option value="">Todos os tipos</option>
                                    <option value="Acidente">Acidente</option>
                                    <option value="Incidente">Incidente</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterSeverity">Gravidade</label>
                                <select id="filterSeverity">
                                    <option value="">Todas as gravidades</option>
                                    <option value="Leve">Leve</option>
                                    <option value="Moderada">Moderada</option>
                                    <option value="Grave">Grave</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterCategory">Categoria</label>
                                <select id="filterCategory">
                                    <option value="">Todas as categorias</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterLocation">Localiza√ß√£o</label>
                                <select id="filterLocation">
                                    <option value="">Todas as localiza√ß√µes</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterBodyPart">Parte do Corpo</label>
                                <select id="filterBodyPart">
                                    <option value="">Todas as partes</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="filterManagement">Ger√™ncia</label>
                                <select id="filterManagement">
                                    <option value="">Todas as ger√™ncias</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-buttons">
                            <button id="applyFilters" class="btn btn-primary">
                                <span aria-hidden="true">üîç</span> Aplicar Filtros
                            </button>
                            <button id="clearFilters" class="btn btn-export">
                                <span aria-hidden="true">üóëÔ∏è</span> Limpar Filtros
                            </button>
                        </div>
                    </div>

                    <!-- Gr√°ficos -->
                    <div class="charts-grid" role="region" aria-label="Gr√°ficos e visualiza√ß√µes">
                        <div class="chart-container full-width">
                            <h3 class="chart-title">üìà Evolu√ß√£o Mensal de Ocorr√™ncias</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesByMonthChart" width="800" height="400" role="img" aria-label="Gr√°fico de evolu√ß√£o mensal de ocorr√™ncias"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">‚öñÔ∏è Distribui√ß√£o por Tipo</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesByTypeChart" width="400" height="400" role="img" aria-label="Gr√°fico de distribui√ß√£o por tipo"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">üìã Ocorr√™ncias por Categoria</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesByCategoryChart" width="400" height="400" role="img" aria-label="Gr√°fico de ocorr√™ncias por categoria"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">üå°Ô∏è Distribui√ß√£o por Gravidade</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesBySeverityChart" width="400" height="400" role="img" aria-label="Gr√°fico de distribui√ß√£o por gravidade"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">üìç Ocorr√™ncias por Localiza√ß√£o</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesByLocationChart" width="400" height="400" role="img" aria-label="Gr√°fico de ocorr√™ncias por localiza√ß√£o"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">üë§ Partes do Corpo Afetadas</h3>
                            <div class="chart-wrapper">
                                <canvas id="occurrencesByBodyPartChart" width="400" height="400" role="img" aria-label="Gr√°fico de partes do corpo afetadas"></canvas>
                            </div>
                        </div>
                        <div class="chart-container full-width">
                            <h3 class="chart-title">üìä Gr√°fico de Controle (C-Chart)</h3>
                            <div class="chart-wrapper">
                                <canvas id="cControlChart" width="800" height="400" role="img" aria-label="Gr√°fico de controle estat√≠stico"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Alto Potencial -->
            <section class="section-card high-potential-section" aria-labelledby="high-potential-heading">
                <div class="section-header">
                    <h2 id="high-potential-heading">‚ö†Ô∏è Dashboard de Eventos de Alto Potencial</h2>
                </div>
                <div class="section-content">
                    <div class="stats-grid" id="highPotentialStats" role="region" aria-label="Estat√≠sticas de alto potencial"></div>
                    
                    <div class="charts-grid">
                        <div class="chart-container full-width">
                            <h3 class="chart-title">‚ö†Ô∏è Evolu√ß√£o de Eventos de Alto Potencial vs Demais</h3>
                            <canvas id="highPotentialTrendChart" role="img" aria-label="Gr√°fico de evolu√ß√£o de eventos de alto potencial"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">‚ö†Ô∏è Alto Potencial por Categoria</h3>
                            <canvas id="highPotentialByCategoryChart" role="img" aria-label="Gr√°fico de alto potencial por categoria"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">‚ö†Ô∏è Alto Potencial por Localiza√ß√£o</h3>
                            <canvas id="highPotentialByLocationChart" role="img" aria-label="Gr√°fico de alto potencial por localiza√ß√£o"></canvas>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <div id="exportModal" class="modal" role="dialog" aria-labelledby="export-modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="export-modal-title">üìä Exportar Relat√≥rio</h2>
                <button class="close" onclick="occurrenceManager.closeModal('exportModal')" aria-label="Fechar modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exportFormat">Formato:</label>
                    <select id="exportFormat">
                        <option value="csv">CSV</option>
                        <option value="json">JSON</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="exportPeriod">Per√≠odo:</label>
                    <select id="exportPeriod">
                        <option value="all">Todos os dados</option>
                        <option value="lastMonth">√öltimo m√™s</option>
                        <option value="last3Months">√öltimos 3 meses</option>
                        <option value="lastYear">√öltimo ano</option>
                        <option value="custom">Per√≠odo personalizado</option>
                    </select>
                </div>
                <div id="customPeriod" class="form-group" style="display: none;">
                    <label for="exportStartDate">Data inicial:</label>
                    <input type="date" id="exportStartDate">
                    <label for="exportEndDate">Data final:</label>
                    <input type="date" id="exportEndDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="occurrenceManager.exportData()">Exportar</button>
                <button class="btn btn-secondary" onclick="occurrenceManager.closeModal('exportModal')">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="backupModal" class="modal" role="dialog" aria-labelledby="backup-modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="backup-modal-title">üíæ Backup/Restore</h2>
                <button class="close" onclick="occurrenceManager.closeModal('backupModal')" aria-label="Fechar modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Total de registros: <span id="backupInfo">0</span></p>
                <p>√öltimo backup: <span id="lastBackup">Nunca</span></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="occurrenceManager.createBackup()">Criar Backup</button>
                <button class="btn btn-import" onclick="document.getElementById('restoreFile').click()">Restaurar</button>
                <input type="file" id="restoreFile" accept=".json" onchange="occurrenceManager.restoreBackup(event)" style="display: none;">
                <button class="btn btn-secondary" onclick="occurrenceManager.closeModal('backupModal')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/config.js"></script>
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/validation.js"></script>
    <script src="assets/js/charts.js"></script>
    <script src="assets/js/app.js"></script>
</body>
</html>

